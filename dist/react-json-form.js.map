{"version":3,"file":"react-json-form.js","sources":["../src/data.js","../src/components/buttons.js","../src/components/loaders.js","../src/util.js","../src/components/form.js","../src/components/containers.js","../src/ui.js","../src/form.js","../src/renderer.js","../src/index.js"],"sourcesContent":["export function getBlankObject(schema) {\n    let keys = {};\n\n    let schema_keys = schema.keys || schema.properties;\n\n    for (let key in schema_keys) {\n        let value = schema_keys[key];\n        let type = value.type;\n\n        if (type === 'list')\n            type = 'array';\n        else if (type === 'dict')\n            type = 'object';\n\n        if (type === 'array')\n            keys[key] = getBlankArray(value);\n        else if (type === 'object')\n            keys[key] = getBlankObject(value);\n        else if (type === 'boolean')\n            keys[key] = false;\n        else if (type === 'integer' || type === 'number')\n            keys[key] = null;\n        else // string etc.\n            keys[key] = '';\n    }\n\n    return keys;\n}\n\n\nexport function getBlankArray(schema) {\n    let items = [];\n    let type = schema.items.type;\n\n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    if (type === 'array')\n        items.push(getBlankArray(schema.items))\n    else if (type === 'object')\n        items.push(getBlankObject(schema.items));\n    else if (type === 'boolean')\n        items.push(false);\n    else if (type === 'integer' || type === 'number')\n        items.push(null);\n    else // string, etc.\n        items.push('');\n\n    return items;\n}\n\n\nexport function getBlankData(schema) {\n    let type = schema.type;\n\n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    if (type === 'array')\n        return getBlankArray(schema);\n    else if (type === 'object')\n        return getBlankObject(schema);\n    else if (type === 'boolean')\n        return false;\n    else if (type === 'integer' || type === 'number')\n        return null;\n    else // string, etc.\n        return '';\n}\n\n\n\nfunction getSyncedArray(data, schema) {\n    let newData = JSON.parse(JSON.stringify(data));\n\n    let type = schema.items.type;\n    \n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    for (let i = 0; i < data.length; i++) {\n        let item = data[i];\n\n        if (type === 'array') {\n            newData[i] = getSyncedArray(item, schema.items);\n        } else if (type === 'object') {\n            newData[i] = getSyncedObject(item, schema.items);\n        }\n        else {\n            if ((type === 'integer' || type === 'number') && item === '')\n                newData[i] = null;\n        }\n    }\n\n    return newData;\n}\n\n\nfunction getSyncedObject(data, schema) {\n    let newData = JSON.parse(JSON.stringify(data));\n\n    let schema_keys = schema.keys || schema.properties;\n\n    let keys = [...Object.keys(schema_keys)];\n\n    for (let i = 0; i < keys.length; i++) {\n        let key = keys[i];\n        let schemaValue = schema_keys[key];\n        let type = schemaValue.type;\n    \n        if (type === 'list')\n            type = 'array';\n        else if (type === 'dict')\n            type = 'object';\n      \n        if (!data.hasOwnProperty(key)) {\n            if (type === 'array')\n                newData[key] = getSyncedArray([], schemaValue);\n            else if (type === 'object')\n                newData[key] = getSyncedObject({}, schemaValue);\n            else if (type === 'boolean')\n                newData[key] = false;\n            else if (type === 'integer' || type === 'number')\n                newData[key] = null;\n            else\n                newData[key] = '';\n        } else {\n            if (type === 'array')\n                newData[key] = getSyncedArray(data[key], schemaValue);\n            else if (type === 'object')\n                newData[key] = getSyncedObject(data[key], schemaValue);\n            else {\n                if ((type === 'integer' || type === 'number') && data[key] === '')\n                    newData[key] = null;\n                else\n                    newData[key] = data[key];\n            }\n        }\n        \n    }\n\n    return newData;\n}\n\n\nexport function getSyncedData(data, schema) {\n    // adds those keys to data which are in schema but not in data\n\n    let type = schema.type;\n    \n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    if (type === 'array') {\n        return getSyncedArray(data, schema);\n    } else if (type === 'object') {\n        return getSyncedObject(data, schema);\n    }\n\n    return data;\n}\n","export default function Button({className, ...props}) {\n    if (!className)\n        className = '';\n\n    let classes = className.split(' ');\n\n    className = '';\n    for (let i = 0; i < classes.length; i++) {\n        className = className + 'rjf-' + classes[i] + '-button ';\n    }\n\n    return (\n        <button \n            className={className.trim()}\n            type=\"button\"\n            {...props}\n        >\n            {props.children}\n        </button>\n    );\n}","export default function Loader (props) {\n    return <div className=\"rjf-loader\"></div>;\n}\n","export const EditorContext = React.createContext();\n\n\nexport function capitalize(string) {\n    if (!string)\n        return '';\n    \n    return string.charAt(0).toUpperCase() + string.substr(1).toLowerCase();\n}\n\n\nexport function getVerboseName(name) {\n    if (name === undefined || name === null)\n        return '';\n\n    name = name.replace(/_/g, ' ');\n    return capitalize(name);\n}\n\n\nexport function getCsrfCookie() {\n    if ((document.cookie.split(';').filter((item) => item.trim().indexOf('csrftoken=') === 0)).length) {\n        return document.cookie.split(';').filter((item) => item.trim().indexOf('csrftoken=') === 0)[0].split('=')[1];\n    }\n    return null;\n}\n","import Button from './buttons';\nimport Loader from './loaders';\nimport {EditorContext, getCsrfCookie, capitalize} from '../util';\n\n\nexport function FormInput({label, help_text, error, inputRef, ...props}) {\n\n    if (props.type === 'string')\n        props.type = 'text'\n\n    if (inputRef)\n        props.ref = inputRef;\n\n    if (props.type === 'number' && props.value === null)\n        props.value = '';\n\n    return (\n        <div>\n            {label && <label>{label}</label>}\n            <input {...props} />\n        </div>\n    );\n}\n\n\nexport function FormCheckInput({label, help_text, error, value, ...props}) {\n\n    if (!label)\n        label = props.name.toUpperCase();\n\n    if (props.type === 'bool')\n        props.type = 'checkbox';\n\n    if (props.checked === undefined)\n        props.checked = value;\n\n    if (props.checked === '' || props.checked === null || props.checked === undefined)\n        props.checked = false\n\n    return (\n        <div>\n            <label><input {...props} /> {label}</label>\n        </div>\n    );\n}\n\n\nexport function FormRadioInput({label, help_text, error, value, options, ...props}) {\n    return (\n        <div>\n            <label>{label}</label>\n            {options.map((option, i) => {\n                let label, inputValue;\n                if (typeof option === 'object') {\n                    label = option.label;\n                    inputValue = option.value;\n                } else {\n                    label = option;\n                    if (typeof label === 'boolean')\n                        label = capitalize(label.toString());\n                    inputValue = option;\n                }\n\n                return (\n                    <label key={label + '_' + inputValue + '_' + i}>\n                        <input {...props} value={inputValue} checked={inputValue === value} /> {label}\n                    </label>\n                );\n            })}\n        </div>\n    );\n}\n\n\nexport function FormSelectInput({label, help_text, error, value, options, ...props}) {\n    return (\n        <div>\n            {label && <label>{label}</label>}\n            <select value={value || ''} {...props}>\n                <option disabled value=\"\" key={'__placehlder'}>Select...</option>\n                {options.map((option, i) => {\n                    let label, inputValue;\n                    if (typeof option === 'object') {\n                        label = option.label;\n                        inputValue = option.value;\n                    } else {\n                        label = option;\n                        if (typeof label === 'boolean')\n                            label = capitalize(label.toString());\n                        inputValue = option;\n                    }\n\n                    return (\n                        <option value={inputValue} key={label + '_' + inputValue + '_' + i}>\n                            {label}\n                        </option>\n                    );\n                })}\n            </select>\n        </div>\n    );\n}\n\nexport function dataURItoBlob(dataURI) {\n      // Split metadata from data\n      const splitted = dataURI.split(\",\");\n      // Split params\n      const params = splitted[0].split(\";\");\n      // Get mime-type from params\n      const type = params[0].replace(\"data:\", \"\");\n      // Filter the name property from params\n      const properties = params.filter(param => {\n            return param.split(\"=\")[0] === \"name\";\n      });\n      // Look for the name and use unknown if no name property.\n      let name;\n      if (properties.length !== 1) {\n            name = \"unknown\";\n      } else {\n            // Because we filtered out the other property,\n            // we only have the name case here.\n            name = properties[0].split(\"=\")[1];\n      }\n\n      // Built the Uint8Array Blob parameter from the base64 string.\n      const binary = atob(splitted[1]);\n      const array = [];\n      for (let i = 0; i < binary.length; i++) {\n            array.push(binary.charCodeAt(i));\n      }\n      // Create the blob object\n      const blob = new window.Blob([new Uint8Array(array)], { type });\n\n      return {blob, name};\n}\n\n\n\nexport class FormFileInput extends React.Component {\n    static contextType = EditorContext;\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            value: props.value,\n            fileName: this.getFileName(),\n            loading: false\n        };\n\n        this.inputRef = React.createRef();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.props.value !== prevProps.value) {\n            this.setState({\n                value: this.props.value, \n                fileName: this.getFileName()\n            });\n        }\n    }\n\n    getFileName = () => {\n        if (!this.props.value)\n            return '';\n\n        if (this.props.type === 'data-url') {\n            return this.extractFileInfo(this.props.value).name;\n        } else if (this.props.type === 'file-url') {\n            return this.props.value;\n        } else {\n            return 'Unknown file';\n        }\n    }\n\n    extractFileInfo = (dataURL) => {\n        const {blob, name} = dataURItoBlob(dataURL);\n        return {\n            name: name,\n            size: blob.size,\n            type: blob.type\n        }\n    }\n\n    addNameToDataURL = (dataURL, name) => {\n        return dataURL.replace(';base64', ';name=' + encodeURIComponent(name) + ';base64');\n    }\n\n    handleChange = (e) => {\n        if (this.props.type === 'data-url') {\n            let file = e.target.files[0];\n            let fileName = file.name\n\n            let reader = new FileReader();\n\n            reader.onload = () => {\n\n                // this.setState({src: reader.result});\n\n                // we create a fake event object\n                let event = {\n                    target: {\n                        type: 'text',\n                        value: this.addNameToDataURL(reader.result, fileName),\n                        name: this.props.name\n                    }\n                };\n\n                this.props.onChange(event);\n\n            }\n            reader.readAsDataURL(file);\n        } else if (this.props.type === 'file-url') {\n            let endpoint = this.context.fileUploadEndpoint;\n            if (!endpoint) {\n                console.error(\n                    \"Error: fileUploadEndpoint option need to be passed \"\n                    + \"while initializing editor for enabling file uploads.\");\n                alert(\"Files can't be uploaded.\");\n                return;\n            }\n\n            this.setState({loading: true});\n\n            let formData = new FormData();\n            formData.append('field_name', this.context.fieldName);\n            formData.append('model_name', this.context.modelName);\n            formData.append('coordinates', JSON.stringify(this.props.name.split('-').slice(1)));\n            formData.append('file', e.target.files[0]);\n\n            fetch(endpoint, {\n                method: 'POST',\n                headers: {\n                    'X-CSRFToken': getCsrfCookie(),\n                },\n                body: formData\n            })\n            .then((response) => response.json())\n            .then((result) => {\n                // we create a fake event object\n                let event = {\n                    target: {\n                        type: 'text',\n                        value: result.file_path,\n                        name: this.props.name\n                    }\n                };\n\n                this.props.onChange(event);\n                this.setState({loading: false});\n            })\n            .catch((error) => {\n                alert('Something went wrong while uploading file');\n                console.error('Error:', error);\n                this.setState({loading: false});\n            });\n\n        }\n\n    }\n\n    showFileBrowser = () => {\n        this.inputRef.current.click();\n    }\n\n    render() {\n        let {label, value, ...props} = {value, ...this.props};\n        props.type = 'file';\n        props.onChange = this.handleChange;\n\n        return (\n            <div>\n                {label && <label>{label}</label>}\n                <div className=\"rjf-file-field\">\n                    {this.state.value && \n                        <div className=\"rjf-current-file-name\">Current file: <span>{this.state.fileName}</span></div>\n                    }\n                    {this.state.value && !this.state.loading && 'Change:'}\n                    {this.state.loading ?\n                        <div className=\"rjf-file-field-loading\"><Loader/> Uploading...</div>\n                    : \n                    <div className=\"rjf-file-field-input\">\n                        <FormInput {...props} inputRef={this.inputRef} />\n                    </div>\n                    }\n                    </div>\n            </div>\n        );\n    }\n}\n\n\nexport function FormTextareaInput({label, help_text, error, inputRef, ...props}) {\n\n    delete props.type;\n\n    if (inputRef)\n        props.ref = inputRef;\n\n    return (\n        <div>\n            {label && <label>{label}</label>}\n            <textarea {...props} />\n        </div>\n    );\n}\n","import Button from './buttons';\n\n\nexport function GroupTitle(props) {\n    if (!props.children)\n        return null;\n\n    return (\n        <div className=\"rjf-form-group-title\">{props.children}</div>\n    );\n}\n\n\nexport function FormRowControls(props) {\n    return (\n        <div className=\"rjf-form-row-controls\">\n            {props.onMoveUp &&\n                <Button \n                    className=\"move-up\"\n                    onClick={props.onMoveUp}\n                    title=\"Move up\"\n                >\n                    <span>&uarr;</span>\n                </Button>\n            }\n            {props.onMoveDown &&\n                <Button \n                    className=\"move-down\"\n                    onClick={props.onMoveDown}\n                    title=\"Move down\"\n                >\n                    <span>&darr;</span>\n                </Button>\n            }\n            {props.onRemove &&\n                <Button \n                    className=\"remove\"\n                    onClick={props.onRemove}\n                    title=\"Remove\"\n                >\n                    <span>&times;</span>\n                </Button>\n            }\n        </div>\n    );\n}\n\nexport function FormRow(props) {\n    return (\n        <div className=\"rjf-form-row\">\n            <FormRowControls {...props} />\n            <div className=\"rjf-form-row-inner\">\n                {props.children}\n            </div>\n        </div>\n    );\n}\n\n\nexport function FormGroup(props) {\n    let hasChildren = React.Children.count(props.children);\n\n    let innerClassName = props.level === 0 && !hasChildren\n        ? \"\" \n        : \"rjf-form-group-inner\";\n\n    return (\n        <div className=\"rjf-form-group\">\n            {props.level === 0 && <GroupTitle>{props.schema.title}</GroupTitle>}\n            <div className={innerClassName}>\n                {props.level > 0 && <GroupTitle>{props.schema.title}</GroupTitle>}\n                {props.children}\n                {props.addable && \n                <Button\n                    className=\"add\"\n                    onClick={(e) => props.onAdd()}\n                    title=\"Add new\"\n                >\n                    {hasChildren ? 'Add more' : 'Add'}\n                </Button>\n                }\n            </div>\n        </div>\n    );\n}\n","import {getBlankData} from './data';\nimport {Button, FormInput, FormCheckInput, FormRadioInput, FormSelectInput,\n    FormFileInput, FormRow, FormGroup, FormRowControls, FormTextareaInput} from './components';\nimport {getVerboseName} from './util';\n\n\nfunction handleChange(e, fieldType, callback) {\n    let type = e.target.type\n    let value;\n\n    if (type === 'checkbox') {\n        value = e.target.checked;\n    } else {\n        value = e.target.value;\n    }\n\n    if (fieldType === 'number' || fieldType === 'integer') {\n        value = value.trim();\n        if (value === '')\n            value = null;\n        else if (!isNaN(Number(value)))\n            value = Number(value);\n    } else if (fieldType === 'boolean') {\n        if (value === 'false' || value === false)\n            value = false;\n        else\n            value = true;\n    }\n\n    callback(e.target.name, value);\n}\n\n\nfunction FormField(props) {\n    let inputProps = {\n        name: props.name,\n        value: props.data,\n    };\n\n    let type = props.schema.type;\n    if (props.schema.choices) {\n        inputProps.options = props.schema.choices;\n        type = 'select';\n    }\n    if (props.schema.widget)\n        type = props.schema.widget;\n\n    let InputField;\n\n    switch (type) {\n        case 'string':\n            InputField = FormInput;\n\n            if (props.schema.format) {\n                if (props.schema.format === 'data-url' || props.schema.format === 'file-url') {\n                    InputField = FormFileInput;\n                }\n                inputProps.type = props.schema.format;\n            }\n            else {\n                inputProps.type = 'text';\n            }\n            break;\n        case 'number':\n            inputProps.type = 'number';\n            InputField = FormInput;\n            break;\n        case 'integer':\n            inputProps.type = 'number';\n            inputProps.step = '1';\n            InputField = FormInput;\n            break;\n        case 'boolean':\n            inputProps.type = 'checkbox';\n            InputField = FormCheckInput;\n            break;\n        case 'checkbox':\n            inputProps.type = 'checkbox';\n            InputField = FormCheckInput;\n            break;\n        case 'radio':\n            inputProps.type = 'radio';\n            InputField = FormRadioInput;\n            break;\n        case 'select':\n            InputField = FormSelectInput;\n            break;\n        case 'textarea':\n            InputField = FormTextareaInput;\n            break;\n        default:\n            inputProps.type = 'text';\n            InputField = FormInput;\n    }\n\n   return (\n        <InputField \n            {...inputProps}\n            label={\n                props.editable ? <span>{props.schema.title} <Button className=\"edit\" onClick={props.onEdit} title=\"Edit\">Edit</Button></span>\n                :\n                props.schema.title\n            }\n            onChange={(e) => handleChange(e, props.schema.type, props.onChange)}\n        />\n    );\n}\n\n\nexport function getStringFormRow(args) {\n    let {\n        data, schema, name, onChange, onRemove, removable, onEdit, editable, \n        onMoveUp, onMoveDown\n    } = args;\n\n    return (\n        <FormRow \n            key={name}\n            onRemove={removable ? (e) => onRemove(name) : null}\n            onMoveUp={onMoveUp}\n            onMoveDown={onMoveDown}\n        >\n            <FormField \n                data={data}\n                schema={schema}\n                name={name}\n                onChange={onChange}\n                onEdit={onEdit}\n                editable={editable}\n            />\n        </FormRow>\n    );\n}\n\nexport function getArrayFormRow(args) {\n    let {data, schema, name, onChange, onAdd, onRemove, onMove, level} = args;\n\n    let rows = [];\n    let groups = [];\n\n    let removable = true;\n    let min_items = schema.min_items || schema.minItems || 0;\n    if (data.length <= min_items)\n        removable = false;\n\n    let addable = true;\n    let max_items = schema.max_items || schema.maxItems || 100;\n    if (data.length >= max_items)\n        addable = false;\n\n    let type = schema.items.type;\n    \n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    let nextArgs = {\n        schema: schema.items,\n        onChange: onChange,\n        onAdd: onAdd,\n        onRemove: onRemove,\n        level: level + 1,\n        removable: removable,\n        onMove: onMove,\n    };\n\n    for (let i = 0; i < data.length; i++) {\n        nextArgs.data = data[i];\n        nextArgs.name = name + '-' + i;\n\n        if (i === 0)\n            nextArgs.onMoveUp = null;\n        else\n            nextArgs.onMoveUp = (e) => onMove(name + '-' + i, name + '-' + (i - 1));\n\n        if (i === data.length - 1)\n            nextArgs.onMoveDown = null;\n        else\n            nextArgs.onMoveDown = (e) => onMove(name + '-' + i, name + '-' + (i + 1));;\n\n        if (type === 'array') {\n            groups.push(getArrayFormRow(nextArgs));\n        } else if (type === 'object') {\n            groups.push(getObjectFormRow(nextArgs));\n        } else {\n            rows.push(getStringFormRow(nextArgs));\n        } \n    }\n\n    let coords = name; // coordinates for insertion and deletion\n\n    if (rows.length || (!rows.length && !groups.length)) {\n        rows = (\n            <FormGroup\n                level={level}\n                schema={schema}\n                addable={addable}\n                onAdd={() => onAdd(getBlankData(schema.items), coords)}\n                key={'row_group_' + name}\n            >\n                {rows}\n            </FormGroup>\n        );\n    }\n\n    if (groups.length) {\n        let groupTitle = schema.title ? <div className=\"rjf-form-group-title\">{schema.title}</div> : null;\n\n        groups = (\n            <div key={'group_' + name}>\n                {groupTitle}\n                {groups.map((i, index) => (\n                    <div className=\"rjf-form-group-wrapper\" key={'group_wrapper_' + name + '_' + index}>\n                        <FormRowControls\n                            onRemove={removable ? (e) => onRemove(name + '-' + index) : null}\n                            onMoveUp={index > 0 ? (e) => onMove(name + '-' + index, name + '-' + (index - 1)) : null}\n                            onMoveDown={index < groups.length - 1 ? (e) => onMove(name + '-' + index, name + '-' + (index + 1)) : null}\n                        />\n                        {i}\n                    </div>\n                    )\n                )}\n                {addable && \n                    <Button\n                        className=\"add\"\n                        onClick={(e) => onAdd(getBlankData(schema.items), coords)}\n                        title=\"Add new\"\n                    >\n                        Add item\n                    </Button>\n                }\n            </div>\n        )\n    }\n\n    return [...rows, ...groups];\n}\n\n\nexport function getObjectFormRow(args) {\n    let {data, schema, name, onChange, onAdd, onRemove, level, onMove} = args;\n\n    let rows = [];\n\n    let schema_keys = schema.keys || schema.properties;\n\n    let keys = [...Object.keys(schema_keys)];\n\n    if (schema.additionalProperties)\n        keys = [...keys, ...Object.keys(data).filter((k) => keys.indexOf(k) === -1)];\n\n    for (let i = 0; i < keys.length; i++) {\n        let key = keys[i];\n        let value = data[key];\n        let childName = name + '-' + key;\n        let schemaValue = schema_keys[key] || {type: 'string'};\n\n        let type = schemaValue.type;\n    \n        if (type === 'list')\n            type = 'array';\n        else if (type === 'dict')\n            type = 'object';\n\n        if (!schemaValue.title)\n            schemaValue.title = getVerboseName(key);\n\n        let removable = false;\n        if (schema_keys[key] === undefined)\n            removable = true;\n\n        let nextArgs = {\n            data: value,\n            schema: schemaValue,\n            name: childName,\n            onChange: onChange,\n            onAdd: onAdd,\n            onRemove: onRemove,\n            level: level + 1,\n            removable: removable,\n            onMove: onMove\n        };\n\n         if (type === 'array') {\n            rows.push(getArrayFormRow(nextArgs));\n        } else if (type === 'object') {\n            rows.push(getObjectFormRow(nextArgs));\n        } else {\n            nextArgs.onEdit = () => handleKeyEdit(data, key, value, childName, onAdd, onRemove);\n            nextArgs.editable = removable;\n            rows.push(getStringFormRow(nextArgs));\n        }\n    }\n\n    if (rows.length || schema.additionalProperties) {\n        let className = \"rjf-form-group-inner\";\n        if (level === 0 && !rows.length)\n            className = \"\";\n        \n        let coords = name;\n\n        rows = (\n            <FormGroup\n                level={level}\n                schema={schema}\n                addable={schema.additionalProperties}\n                onAdd={() => handleKeyValueAdd(data, coords, onAdd)}\n                key={'row_group_' + name}\n            >\n                {rows}\n            </FormGroup>\n        );\n    }\n\n    return rows;\n}\n\n\nfunction handleKeyValueAdd(data, coords, onAdd) {\n    let key = prompt(\"Add new key\");\n    if (key === null) // clicked cancel\n        return;\n\n    key = key.trim();\n    if (!key)\n        alert(\"(!) Can't add empty key.\\r\\n\\r\\n‎\");\n    else if (data.hasOwnProperty(key))\n        alert(\"(!) Duplicate keys not allowed. This key already exists.\\r\\n\\r\\n‎\");\n    else\n        onAdd(\"\", coords + '-' + key);   \n}\n\n\nfunction handleKeyEdit(data, key, value, coords, onAdd, onRemove) {\n    let newKey = prompt(\"Rename key\", key);\n    if (newKey === null) // clicked cancel\n        return;\n\n    newKey = newKey.trim();\n\n    if (newKey === key) // same keys\n        return;\n\n    if (!newKey)\n        return alert(\"(!) Key name can't be empty.\\r\\n\\r\\n‎\");\n    else if (data.hasOwnProperty(newKey))\n        return alert(\"(!) Duplicate keys not allowed. This key already exists.\\r\\n\\r\\n‎\");\n\n    onAdd(value, name + '-' + newKey);\n    onRemove(coords);\n}\n","import {getBlankData, getSyncedData} from './data';\nimport {getArrayFormRow, getObjectFormRow} from './ui';\nimport {EditorContext} from './util';\n\n\nexport default class Form extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.dataInput = document.getElementById(this.props.dataInputId);\n        this.schema = props.schema;\n\n        let data = props.data;\n\n        if (!data) {\n            // create empty data from schema\n            data = getBlankData(this.schema);\n        } else {\n            // data might be stale if schema has new keys, so add them to data\n            try {\n                data = getSyncedData(data, this.schema);\n            } catch (error) {\n                console.error(\"Error: Schema and data structure don't match\");\n                console.error(error);\n            }\n        }\n\n        this.state = {\n            value: '',\n            data: data\n        };\n        \n        // update data in the input\n        this.populateDataInput();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.data !== prevState.data) {\n            this.populateDataInput();\n        }\n    }\n\n    populateDataInput = () => {\n        this.dataInput.value = JSON.stringify(this.state.data);\n    }\n\n    handleChange = (coords, value) => {\n        /*\n            e.target.name is a chain of indices and keys:\n            xxx-0-key-1-key2 and so on.\n            These can be used as coordinates to locate \n            a particular deeply nested item.\n\n            This first coordinate is not important and should be removed.\n        */\n        coords = coords.split('-');\n\n        coords.shift(); // remove first coord\n\n        function setDataUsingCoords(coords, data, value) {\n            let coord = coords.shift();\n            if (!isNaN(Number(coord)))\n                coord = Number(coord);\n\n            if (coords.length) {\n                setDataUsingCoords(coords, data[coord], value);\n            } else {\n                data[coord] = value;\n            }\n        }\n\n        let _data = JSON.parse(JSON.stringify(this.state.data));\n\n        setDataUsingCoords(coords, _data, value);\n\n        this.setState({data: _data});\n    }\n\n    getFields = () => {\n        let data = this.state.data;\n        let formGroups = [];\n\n        try {\n            let type = this.schema.type;\n    \n            if (type === 'list')\n                type = 'array';\n            else if (type === 'dict')\n                type = 'object';\n\n            let args = {\n                data: data,\n                schema: this.schema,\n                name: 'rjf',\n                onChange: this.handleChange,\n                onAdd: this.addFieldset,\n                onRemove: this.removeFieldset,\n                onMove: this.moveFieldset,\n                level: 0\n            };\n\n            if (type === 'array') {\n                return getArrayFormRow(args);\n            } else if (type === 'object') {\n                return getObjectFormRow(args);\n            }\n        } catch (error) {\n            formGroups = (\n                <p style={{color: '#f00'}}>\n                    <strong>(!) Error:</strong> Schema and data structure do not match.\n                </p>\n            );\n        }\n\n        return formGroups;\n    }\n\n    addFieldset = (blankData, coords) => {\n        coords = coords.split('-');\n        coords.shift();\n\n        this.setState((state) => {\n            let _data = JSON.parse(JSON.stringify(state.data));\n\n            addDataUsingCoords(coords, _data, blankData);\n\n            return {data: _data};\n        });\n    }\n\n    removeFieldset = (coords) => {\n        coords = coords.split('-');\n        coords.shift();\n\n        this.setState((state) => {\n            let _data = JSON.parse(JSON.stringify(state.data));\n\n            removeDataUsingCoords(coords, _data);\n\n            return {data: _data};\n        });\n    }\n\n    moveFieldset = (oldCoords, newCoords) => {\n        oldCoords = oldCoords.split(\"-\");\n        oldCoords.shift();\n\n        newCoords = newCoords.split(\"-\");\n        newCoords.shift();\n\n        this.setState((state) => {\n            let _data = JSON.parse(JSON.stringify(state.data));\n\n            moveDataUsingCoords(oldCoords, newCoords, _data);\n\n            return {data: _data};\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"rjf-form-wrapper\">\n                <fieldset className=\"module aligned\">\n                    <EditorContext.Provider \n                        value={{\n                            fileUploadEndpoint: this.props.fileUploadEndpoint,\n                            fieldName: this.props.fieldName,\n                            modelName: this.props.modelName,\n                        }}\n                    >\n                    {this.getFields()}\n                    </EditorContext.Provider>\n                </fieldset>\n            </div>\n        );\n    }\n}\n\n\nfunction addDataUsingCoords(coords, data, value) {\n    let coord = coords.shift();\n    if (!isNaN(Number(coord)))\n        coord = Number(coord);\n\n    if (coords.length) {\n        addDataUsingCoords(coords, data[coord], value);\n    } else {\n        if (Array.isArray(data[coord])) {\n            data[coord].push(value);\n        }\n        else {\n            if (Array.isArray(data)) {\n                data.push(value);\n            } else {\n                data[coord] = value;\n            }\n        }\n    }\n}\n\nfunction removeDataUsingCoords(coords, data) {\n    let coord = coords.shift();\n    if (!isNaN(Number(coord)))\n        coord = Number(coord);\n\n    if (coords.length) {\n        removeDataUsingCoords(coords, data[coord]);\n    } else {\n        if (Array.isArray(data))\n            data.splice(coord, 1); // in-place mutation\n        else\n            delete data[coord];\n    }\n}\n\n\nfunction moveDataUsingCoords(oldCoords, newCoords, data) {\n    let oldCoord = oldCoords.shift();\n\n    if (!isNaN(Number(oldCoord)))\n        oldCoord = Number(oldCoord);\n\n    if (oldCoords.length) {\n        moveDataUsingCoords(oldCoords, newCoords, data[oldCoord]);\n    } else {\n        if (Array.isArray(data)) {\n            /* Using newCoords allows us to move items from \n            one array to another. \n            However, for now, we're only moving items in a \n            single array.\n            */\n            let newCoord = newCoords[newCoords.length - 1];\n            \n            let item = data[oldCoord];\n\n            data.splice(oldCoord, 1);\n            data.splice(newCoord, 0, item);\n        }\n    }\n}\n","import Form from './form';\n\n\nexport default function JSONForm(config) {\n    this.containerId = config.containerId;\n    this.dataInputId = config.dataInputId;\n    this.schema = config.schema;\n    this.data = config.data;\n    this.fileUploadEndpoint = config.fileUploadEndpoint;\n    this.fieldName = config.fieldName;\n    this.modelName = config.modelName;\n\n    this.render = function() {\n        ReactDOM.render(\n            <Form\n                schema={this.schema}\n                dataInputId={this.dataInputId}\n                data={this.data}\n                fileUploadEndpoint={this.fileUploadEndpoint}\n                fieldName={this.fieldName}\n                modelName={this.modelName}\n            />,\n            document.getElementById(this.containerId)\n        );\n    }\n}","import JSONForm from './renderer';\n\n\nexport default {\n  JSONForm,\n};"],"names":["getBlankObject","schema","keys","schema_keys","properties","key","value","type","getBlankArray","items","push","getBlankData","getSyncedArray","data","newData","JSON","parse","stringify","i","length","item","getSyncedObject","Object","schemaValue","hasOwnProperty","getSyncedData","Button","className","props","classes","split","trim","children","Loader","EditorContext","React","createContext","capitalize","string","charAt","toUpperCase","substr","toLowerCase","getVerboseName","name","undefined","replace","getCsrfCookie","document","cookie","filter","indexOf","FormInput","label","inputRef","ref","FormCheckInput","checked","FormRadioInput","options","map","option","inputValue","toString","FormSelectInput","dataURItoBlob","dataURI","splitted","params","param","binary","atob","array","charCodeAt","blob","window","Blob","Uint8Array","FormFileInput","getFileName","extractFileInfo","dataURL","size","addNameToDataURL","encodeURIComponent","handleChange","e","file","target","files","fileName","reader","FileReader","onload","event","result","onChange","readAsDataURL","endpoint","context","fileUploadEndpoint","console","error","alert","setState","loading","formData","FormData","append","fieldName","modelName","slice","fetch","method","headers","body","then","response","json","file_path","showFileBrowser","current","click","state","createRef","componentDidUpdate","prevProps","prevState","render","Component","contextType","FormTextareaInput","GroupTitle","FormRowControls","onMoveUp","onMoveDown","onRemove","FormRow","FormGroup","hasChildren","Children","count","innerClassName","level","title","addable","onAdd","fieldType","callback","isNaN","Number","FormField","inputProps","choices","widget","InputField","format","step","editable","onEdit","getStringFormRow","args","removable","getArrayFormRow","onMove","rows","groups","min_items","minItems","max_items","maxItems","nextArgs","getObjectFormRow","coords","groupTitle","index","additionalProperties","k","childName","handleKeyEdit","handleKeyValueAdd","prompt","newKey","Form","populateDataInput","dataInput","shift","setDataUsingCoords","coord","_data","getFields","formGroups","addFieldset","removeFieldset","moveFieldset","color","blankData","addDataUsingCoords","removeDataUsingCoords","oldCoords","newCoords","moveDataUsingCoords","getElementById","dataInputId","Array","isArray","splice","oldCoord","newCoord","JSONForm","config","containerId","ReactDOM"],"mappings":"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"}