{"version":3,"file":"react-json-form.js","sources":["../src/data.js","../src/components/buttons.js","../src/components/loaders.js","../src/util.js","../src/components/form.js","../src/components/containers.js","../src/ui.js","../src/form.js","../src/renderer.js","../src/index.js"],"sourcesContent":["export function getBlankObject(schema) {\n    let keys = {};\n\n    let schema_keys = schema.keys || schema.properties;\n\n    for (let key in schema_keys) {\n        let value = schema_keys[key];\n        let type = value.type;\n\n        if (type === 'list')\n            type = 'array';\n        else if (type === 'dict')\n            type = 'object';\n\n        if (type === 'array')\n            keys[key] = getBlankArray(value);\n        else if (type === 'object')\n            keys[key] = getBlankObject(value);\n        else if (type === 'string')\n            keys[key] = '';\n        else if (schema.type === 'number')\n            return '';\n    }\n\n    return keys;\n}\n\n\nexport function getBlankArray(schema) {\n    let items = [];\n    let type = schema.items.type;\n\n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    if (type === 'array')\n        items.push(getBlankArray(schema.items))\n    else if (type === 'object')\n        items.push(getBlankObject(schema.items));\n    else if (type === 'string')\n        items.push('');\n    else if (schema.type === 'number')\n        items.push('');\n\n    return items;\n}\n\n\nexport function getBlankData(schema) {\n    let type = schema.type;\n\n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    if (type === 'array') {\n        return getBlankArray(schema);\n    }\n    else if (type === 'object') {\n        return getBlankObject(schema);\n    } else if (type === 'string') {\n        return '';\n    } else if (type === 'number') {\n        return '';\n    }\n}\n\n\n\nfunction getSyncedArray(data, schema) {\n    let newData = JSON.parse(JSON.stringify(data));\n\n    let type = schema.items.type;\n    \n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    for (let i = 0; i < data.length; i++) {\n        let item = data[i];\n\n        if (type === 'array') {\n            newData[i] = getSyncedArray(item, schema.items);\n        } else if (type === 'object') {\n            newData[i] = getSyncedObject(item, schema.items);\n        }\n    }\n\n    return newData;\n}\n\n\nfunction getSyncedObject(data, schema) {\n    let newData = JSON.parse(JSON.stringify(data));\n\n    let schema_keys = schema.keys || schema.properties;\n\n    let keys = [...Object.keys(schema_keys)];\n\n    for (let i = 0; i < keys.length; i++) {\n        let key = keys[i];\n        let schemaValue = schema_keys[key];\n        let type = schemaValue.type;\n    \n        if (type === 'list')\n            type = 'array';\n        else if (type === 'dict')\n            type = 'object';\n      \n        if (!data.hasOwnProperty(key)) {\n            if (type === 'string')\n                newData[key] = '';\n            else if (type === 'array')\n                newData[key] = getSyncedArray([], schemaValue);\n            else if (type === 'object')\n                newData[key] = getSyncedObject({}, schemaValue);\n        } else {\n        if (type === 'string')\n                newData[key] = data[key];\n            else if (type === 'array')\n                newData[key] = getSyncedArray(data[key], schemaValue);\n            else if (type === 'object')\n                newData[key] = getSyncedObject(data[key], schemaValue);\n        }\n        \n    }\n\n    return newData;\n}\n\n\nexport function getSyncedData(data, schema) {\n    // adds those keys to data which are in schema but not in data\n\n    let type = schema.type;\n    \n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    if (type === 'array') {\n        return getSyncedArray(data, schema);\n    } else if (type === 'object') {\n        return getSyncedObject(data, schema);\n    }\n\n    return data;\n}\n","export default function Button({className, ...props}) {\n    if (!className)\n        className = '';\n\n    className = 'rjf-' + className + '-button';\n    return (\n        <button \n            className={className}\n            type=\"button\"\n            {...props}\n        >\n            {props.children}\n        </button>\n    );\n}","export default function Loader (props) {\n    return <div className=\"rjf-loader\"></div>;\n}\n","export const EditorContext = React.createContext();\n\n\nexport function capitalize(string) {\n    if (!string)\n        return '';\n    \n    return string.charAt(0).toUpperCase() + string.substr(1).toLowerCase();\n}\n\n\nexport function getVerboseName(name) {\n    if (name === undefined || name === null)\n        return '';\n\n    name = name.replace(/_/g, ' ');\n    return capitalize(name);\n}\n\n\nexport function getCsrfCookie() {\n    if ((document.cookie.split(';').filter((item) => item.trim().indexOf('csrftoken=') === 0)).length) {\n        return document.cookie.split(';').filter((item) => item.trim().indexOf('csrftoken=') === 0)[0].split('=')[1];\n    }\n    return null;\n}\n","import Button from './buttons';\nimport Loader from './loaders';\nimport {EditorContext, getCsrfCookie, capitalize} from '../util';\n\n\nexport function FormInput({label, help_text, error, inputRef, ...props}) {\n\n    if (props.type === 'string')\n        props.type = 'text'\n\n    if (inputRef)\n        props.ref = inputRef;\n\n    return (\n        <div>\n            {label && <label>{label}</label>}\n            <input {...props} />\n        </div>\n    );\n}\n\n\nexport function FormCheckInput({label, help_text, error, value, ...props}) {\n\n    if (!label)\n        label = props.name.toUpperCase();\n\n    if (props.type === 'bool')\n        props.type = 'checkbox';\n\n    if (props.checked === undefined)\n        props.checked = value;\n\n    if (props.checked === '')\n        props.checked = false\n\n    return (\n        <div>\n            <label><input {...props} /> {label}</label>\n        </div>\n    );\n}\n\n\nexport function FormRadioInput({label, help_text, error, value, options, ...props}) {\n    return (\n        <div>\n            <label>{label}</label>\n            {options.map((option, i) => {\n                let label, inputValue;\n                if (typeof option === 'object') {\n                    label = option.label;\n                    inputValue = option.value;\n                } else {\n                    label = option;\n                    if (typeof label === 'boolean')\n                        label = capitalize(label.toString());\n                    inputValue = option;\n                }\n\n                return (\n                    <label key={label + '_' + inputValue + '_' + i}>\n                        <input {...props} value={inputValue} checked={inputValue === value} /> {label}\n                    </label>\n                );\n            })}\n        </div>\n    );\n}\n\n\nexport function FormSelectInput({label, help_text, error, value, options, ...props}) {\n    return (\n        <div>\n            {label && <label>{label}</label>}\n            <select defaultValue=\"\" {...props}>\n                <option disabled value=\"\" key={'__placehlder'}>Select...</option>\n                {options.map((option, i) => {\n                    let label, inputValue;\n                    if (typeof option === 'object') {\n                        label = option.label;\n                        inputValue = option.value;\n                    } else {\n                        label = option;\n                        if (typeof label === 'boolean')\n                            label = capitalize(label.toString());\n                        inputValue = option;\n                    }\n\n                    return (\n                        <option value={inputValue} key={label + '_' + inputValue + '_' + i}>\n                            {label}\n                        </option>\n                    );\n                })}\n            </select>\n        </div>\n    );\n}\n\nexport function dataURItoBlob(dataURI) {\n      // Split metadata from data\n      const splitted = dataURI.split(\",\");\n      // Split params\n      const params = splitted[0].split(\";\");\n      // Get mime-type from params\n      const type = params[0].replace(\"data:\", \"\");\n      // Filter the name property from params\n      const properties = params.filter(param => {\n            return param.split(\"=\")[0] === \"name\";\n      });\n      // Look for the name and use unknown if no name property.\n      let name;\n      if (properties.length !== 1) {\n            name = \"unknown\";\n      } else {\n            // Because we filtered out the other property,\n            // we only have the name case here.\n            name = properties[0].split(\"=\")[1];\n      }\n\n      // Built the Uint8Array Blob parameter from the base64 string.\n      const binary = atob(splitted[1]);\n      const array = [];\n      for (let i = 0; i < binary.length; i++) {\n            array.push(binary.charCodeAt(i));\n      }\n      // Create the blob object\n      const blob = new window.Blob([new Uint8Array(array)], { type });\n\n      return {blob, name};\n}\n\n\n\nexport class FormFileInput extends React.Component {\n    static contextType = EditorContext;\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            value: props.value,\n            fileName: this.getFileName(),\n            loading: false\n        };\n\n        this.inputRef = React.createRef();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.props.value !== prevProps.value) {\n            this.setState({\n                value: this.props.value, \n                fileName: this.getFileName()\n            });\n        }\n    }\n\n    getFileName = () => {\n        if (!this.props.value)\n            return '';\n\n        if (this.props.type === 'data-url') {\n            return this.extractFileInfo(this.props.value).name;\n        } else if (this.props.type === 'file-url') {\n            return this.props.value;\n        } else {\n            return 'Unknown file';\n        }\n    }\n\n    extractFileInfo = (dataURL) => {\n        const {blob, name} = dataURItoBlob(dataURL);\n        return {\n            name: name,\n            size: blob.size,\n            type: blob.type\n        }\n    }\n\n    addNameToDataURL = (dataURL, name) => {\n        return dataURL.replace(';base64', ';name=' + encodeURIComponent(name) + ';base64');\n    }\n\n    handleChange = (e) => {\n        if (this.props.type === 'data-url') {\n            let file = e.target.files[0];\n            let fileName = file.name\n\n            let reader = new FileReader();\n\n            reader.onload = () => {\n\n                // this.setState({src: reader.result});\n\n                // we create a fake event object\n                let event = {\n                    target: {\n                        type: 'text',\n                        value: this.addNameToDataURL(reader.result, fileName),\n                        name: this.props.name\n                    }\n                };\n\n                this.props.onChange(event);\n\n            }\n            reader.readAsDataURL(file);\n        } else if (this.props.type === 'file-url') {\n            let endpoint = this.context.fileUploadEndpoint;\n            if (!endpoint) {\n                console.error(\n                    \"Error: fileUploadEndpoint option need to be passed \"\n                    + \"while initializing editor for enabling file uploads.\");\n                alert(\"Files can't be uploaded.\");\n                return;\n            }\n\n            this.setState({loading: true});\n\n            let formData = new FormData();\n            formData.append('field_name', this.context.fieldName);\n            formData.append('model_name', this.context.modelName);\n            formData.append('coordinates', JSON.stringify(this.props.name.split('-').slice(1)));\n            formData.append('file', e.target.files[0]);\n\n            fetch(endpoint, {\n                method: 'POST',\n                headers: {\n                    'X-CSRFToken': getCsrfCookie(),\n                },\n                body: formData\n            })\n            .then((response) => response.json())\n            .then((result) => {\n                // we create a fake event object\n                let event = {\n                    target: {\n                        type: 'text',\n                        value: result.file_path,\n                        name: this.props.name\n                    }\n                };\n\n                this.props.onChange(event);\n                this.setState({loading: false});\n            })\n            .catch((error) => {\n                alert('Something went wrong while uploading file');\n                console.error('Error:', error);\n                this.setState({loading: false});\n            });\n\n        }\n\n    }\n\n    showFileBrowser = () => {\n        this.inputRef.current.click();\n    }\n\n    render() {\n        let {label, value, ...props} = {value, ...this.props};\n        props.type = 'file';\n        props.onChange = this.handleChange;\n\n        return (\n            <div>\n                {label && <label>{label}</label>}\n                <div className=\"rjf-file-field\">\n                    {this.state.value && \n                        <div className=\"rjf-current-file-name\">Current file: <span>{this.state.fileName}</span></div>\n                    }\n                    {this.state.value && !this.state.loading && 'Change:'}\n                    {this.state.loading ?\n                        <div className=\"rjf-file-field-loading\"><Loader/> Uploading...</div>\n                    : \n                    <div className=\"rjf-file-field-input\">\n                        <FormInput {...props} inputRef={this.inputRef} />\n                    </div>\n                    }\n                    </div>\n            </div>\n        );\n    }\n}\n","import Button from './buttons';\n\n\nexport function GroupTitle(props) {\n    if (!props.children)\n        return null;\n\n    return (\n        <div className=\"rjf-form-group-title\">{props.children}</div>\n    );\n}\n\n\nexport function FormRow(props) {\n    return (\n        <div className=\"rjf-form-row\">\n            {props.onRemove &&\n                <Button \n                    className=\"remove\"\n                    onClick={(e) => props.onRemove(name)}\n                    title=\"Remove\"\n                >\n                    <span>&times;</span>\n                </Button>\n            }\n            <div className=\"rjf-form-row-inner\">\n                {props.children}\n            </div>\n        </div>\n    );\n}\n\n\nexport function FormGroup(props) {\n    let hasChildren = React.Children.count(props.children);\n\n    let innerClassName = props.level === 0 && !hasChildren\n        ? \"\" \n        : \"rjf-form-group-inner\";\n\n    return (\n        <div className=\"rjf-form-group\">\n            {props.level === 0 && <GroupTitle>{props.schema.title}</GroupTitle>}\n            <div className={innerClassName}>\n                {props.level > 0 && <GroupTitle>{props.schema.title}</GroupTitle>}\n                {props.children}\n                {props.addable && \n                <Button\n                    className=\"add\"\n                    onClick={(e) => props.onAdd()}\n                    title=\"Add new\"\n                >\n                    {hasChildren ? 'Add more' : 'Add'}\n                </Button>\n                }\n            </div>\n        </div>\n    );\n}\n","import {getBlankData} from './data';\nimport {Button, FormInput, FormCheckInput, FormRadioInput, FormSelectInput,\n    FormFileInput, FormRow, FormGroup} from './components';\nimport {getVerboseName} from './util';\n\n\nfunction handleChange(e, valueType, callback) {\n    let type = e.target.type\n    let value;\n\n    if (type === 'checkbox') {\n        value = e.target.checked;\n    } else {\n        value = e.target.value;\n    }\n\n    if (valueType === 'number') {\n        value = value.trim();\n        if (value !== '' && !isNaN(Number(value)))\n            value = Number(value);\n    } else if (valueType === 'boolean') {\n        if (value === 'false')\n            value = false;\n        else\n            value = true;\n    }\n\n    callback(e.target.name, value);\n}\n\n\nfunction FormField(props) {\n    let inputProps = {\n        name: props.name,\n        value: props.data,\n    };\n\n    let type = props.schema.type;\n    if (props.schema.choices) {\n        inputProps.options = props.schema.choices;\n        type = 'select';\n    }\n    if (props.schema.widget)\n        type = props.schema.widget;\n\n    let InputField;\n\n    switch (type) {\n        case 'string':\n            InputField = FormInput;\n\n            if (props.schema.format) {\n                if (props.schema.format === 'data-url' || props.schema.format === 'file-url') {\n                    InputField = FormFileInput;\n                }\n                inputProps.type = props.schema.format;\n            }\n            else {\n                inputProps.type = 'text';\n            }\n            break;\n        case 'number':\n            inputProps.type = 'number';\n            InputField = FormInput;\n            break;\n        case 'integer':\n            inputProps.type = 'number';\n            InputField = FormInput;\n            break;\n        case 'boolean':\n            inputProps.type = 'checkbox';\n            InputField = FormCheckInput;\n            break;\n        case 'checkbox':\n            inputProps.type = 'checkbox';\n            InputField = FormCheckInput;\n            break;\n        case 'radio':\n            inputProps.type = 'radio';\n            InputField = FormRadioInput;\n            break;\n        case 'select':\n            InputField = FormSelectInput;\n            break;\n        default:\n            inputProps.type = 'text';\n            InputField = FormInput;\n    }\n\n   return (\n        <InputField \n            {...inputProps}\n            label={\n                props.editable ? <span>{props.schema.title} <Button className=\"edit\" onClick={props.onEdit} title=\"Edit\">Edit</Button></span>\n                :\n                props.schema.title\n            }\n            onChange={(e) => handleChange(e, props.schema.type, props.onChange)}\n        />\n    );\n}\n\n\nexport function getStringFormRow(data, schema, name, onChange, onRemove, removable, onEdit, editable) {\n\n    return (\n        <FormRow \n            key={name}\n            onRemove={removable ? (e) => onRemove(name) : null}\n        >\n            <FormField \n                data={data}\n                schema={schema}\n                name={name}\n                onChange={onChange}\n                onEdit={onEdit}\n                editable={editable}\n            />\n        </FormRow>\n    );\n}\n\nexport function getArrayFormRow(data, schema, name, onChange, onAdd, onRemove, level) {\n    let rows = [];\n    let groups = [];\n\n    let removable = true;\n    let min_items = schema.min_items || schema.minItems || 0;\n    if (data.length <= min_items)\n        removable = false;\n\n    let addable = true;\n    let max_items = schema.max_items || schema.maxItems || 100;\n    if (data.length >= max_items)\n        addable = false;\n\n    let type = schema.items.type;\n    \n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    for (let i = 0; i < data.length; i++) {\n        let item = data[i];\n        let childName = name + '-' + i;\n\n        if (type === 'array') {\n            groups.push(getArrayFormRow(item, schema.items, childName, onChange, onAdd, onRemove, level + 1));\n        } else if (type === 'object') {\n            groups.push(getObjectFormRow(item, schema.items, childName, onChange, onAdd, onRemove, level + 1));\n        } else {\n            rows.push(getStringFormRow(item, schema.items, childName, onChange, onRemove, removable));\n        } \n    }\n\n    let coords = name; // coordinates for insertion and deletion\n\n    if (rows.length || (!rows.length && !groups.length)) {\n        rows = (\n            <FormGroup\n                level={level}\n                schema={schema}\n                addable={addable}\n                onAdd={() => onAdd(getBlankData(schema.items), coords)}\n                key={'row_group_' + name}\n            >\n                {rows}\n            </FormGroup>\n        );\n    }\n\n    if (groups.length) {\n        let groupTitle = schema.title ? <div className=\"rjf-form-group-title\">{schema.title}</div> : null;\n\n        groups = (\n            <div key={'group_' + name}>\n                {groupTitle}\n                {groups.map((i, index) => (\n                    <div className=\"rjf-form-group-wrapper\" key={'group_wrapper_' + name + '_' + index}>\n                        {removable && \n                            <Button\n                                className=\"remove\"\n                                onClick={(e) => onRemove(name + '-' + index)}\n                                title=\"Remove\"\n                            >\n                                <span>&times;</span>\n                            </Button>\n                        }\n                        {i}\n                    </div>\n                    )\n                )}\n                {addable && \n                    <Button\n                        className=\"add\"\n                        onClick={(e) => onAdd(getBlankData(schema.items), coords)}\n                        title=\"Add new\"\n                    >\n                        Add item\n                    </Button>\n                }\n            </div>\n        )\n    }\n\n    return [...rows, ...groups];\n}\n\n\nexport function getObjectFormRow(data, schema, name, onChange, onAdd, onRemove, level) {\n    let rows = [];\n\n    schema_keys = schema.keys || schema.properties;\n\n    let keys = [...Object.keys(schema_keys)];\n\n    if (schema.additionalProperties)\n        keys = [...keys, ...Object.keys(data).filter((k) => keys.indexOf(k) === -1)];\n\n    for (let i = 0; i < keys.length; i++) {\n        let key = keys[i];\n        let value = data[key];\n        let childName = name + '-' + key;\n        let schemaValue = schema_keys[key] || {type: 'string'};\n\n        let type = schemaValue.type;\n    \n        if (type === 'list')\n            type = 'array';\n        else if (type === 'dict')\n            type = 'object';\n\n        if (!schemaValue.title)\n            schemaValue.title = getVerboseName(key);\n\n        let removable = false;\n        if (schema_keys[key] === undefined)\n            removable = true;\n\n         if (type === 'array') {\n            rows.push(getArrayFormRow(value, schemaValue, childName, onChange, onAdd, onRemove, level + 1));\n        } else if (type === 'object') {\n            rows.push(getObjectFormRow(value, schemaValue, childName, onChange, onAdd, onRemove, level + 1));\n        } else {\n            rows.push(getStringFormRow(\n                value, schemaValue, childName, onChange, onRemove, removable, \n                () => handleKeyEdit(data, key, value, childName, onAdd, onRemove),\n                removable\n            ));\n        }\n    }\n\n    if (rows.length || schema.additionalProperties) {\n        let className = \"rjf-form-group-inner\";\n        if (level === 0 && !rows.length)\n            className = \"\";\n        \n        let coords = name;\n\n        rows = (\n            <FormGroup\n                level={level}\n                schema={schema}\n                addable={schema.additionalProperties}\n                onAdd={() => handleKeyValueAdd(data, coords, onAdd)}\n                key={'row_group_' + name}\n            >\n                {rows}\n            </FormGroup>\n        );\n    }\n\n    return rows;\n}\n\n\nfunction handleKeyValueAdd(data, coords, onAdd) {\n    let key = prompt(\"Add new key\");\n    if (key === null) // clicked cancel\n        return;\n\n    key = key.trim();\n    if (!key)\n        alert(\"(!) Can't add empty key.\\r\\n\\r\\n‎\");\n    else if (data.hasOwnProperty(key))\n        alert(\"(!) Duplicate keys not allowed. This key already exists.\\r\\n\\r\\n‎\");\n    else\n        onAdd(\"\", coords + '-' + key);   \n}\n\n\nfunction handleKeyEdit(data, key, value, coords, onAdd, onRemove) {\n    let newKey = prompt(\"Rename key\", key);\n    if (newKey === null) // clicked cancel\n        return;\n\n    newKey = newKey.trim();\n\n    if (newKey === key) // same keys\n        return;\n\n    if (!newKey)\n        return alert(\"(!) Key name can't be empty.\\r\\n\\r\\n‎\");\n    else if (data.hasOwnProperty(newKey))\n        return alert(\"(!) Duplicate keys not allowed. This key already exists.\\r\\n\\r\\n‎\");\n\n    onAdd(value, name + '-' + newKey);\n    onRemove(coords);\n}\n","import {getBlankData, getSyncedData} from './data';\nimport {getArrayFormRow, getObjectFormRow} from './ui';\nimport {EditorContext} from './util';\n\n\nexport default class Form extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.dataInput = document.getElementById(this.props.dataInputId);\n        this.schema = props.schema;\n\n        let data = props.data;\n\n        if (!data) {\n            // create empty data from schema\n            data = getBlankData(this.schema);\n        } else {\n            // data might be stale if schema has new keys, so add them to data\n            try {\n                data = getSyncedData(data, this.schema);\n            } catch (error) {\n                console.log(\"Error: Schema and data don't match\");\n                console.log(error);\n            }\n        }\n\n        this.state = {\n            value: '',\n            data: data\n        };\n        \n        // update data in the input\n        this.populateDataInput();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.data !== prevState.data) {\n            this.populateDataInput();\n        }\n    }\n\n    populateDataInput = () => {\n        this.dataInput.value = JSON.stringify(this.state.data);\n    }\n\n    handleChange = (coords, value) => {\n        /*\n            e.target.name is a chain of indices and keys:\n            xxx-0-key-1-key2 and so on.\n            These can be used as coordinates to locate \n            a particular deeply nested item.\n\n            This first coordinate is not important and should be removed.\n        */\n        coords = coords.split('-');\n\n        coords.shift(); // remove first coord\n\n        function setDataUsingCoords(coords, data, value) {\n            let coord = coords.shift();\n            if (!isNaN(Number(coord)))\n                coord = Number(coord);\n\n            if (coords.length) {\n                setDataUsingCoords(coords, data[coord], value);\n            } else {\n                data[coord] = value;\n            }\n        }\n\n        let _data = JSON.parse(JSON.stringify(this.state.data));\n\n        setDataUsingCoords(coords, _data, value);\n\n        this.setState({data: _data});\n    }\n\n    getFields = () => {\n        let data = this.state.data;\n        let formGroups = [];\n\n        try {\n            let type = this.schema.type;\n    \n            if (type === 'list')\n                type = 'array';\n            else if (type === 'dict')\n                type = 'object';\n\n            if (type === 'array') {\n                return getArrayFormRow(\n                    data, this.schema, 'rjf',\n                    this.handleChange, this.addFieldset, this.removeFieldset,\n                    0\n                );\n            } else if (type === 'object') {\n                return getObjectFormRow(\n                    data, this.schema, 'rjf',\n                    this.handleChange, this.addFieldset, this.removeFieldset,\n                    0\n                );\n            }\n        } catch (error) {\n            formGroups = (\n                <p style={{color: '#f00'}}>\n                    <strong>(!) Error:</strong> Schema and data do not match.\n                </p>\n            );\n        }\n\n        return formGroups;\n    }\n\n    addFieldset = (blankData, coords) => {\n        coords = coords.split('-');\n        coords.shift();\n\n        this.setState((state) => {\n            function addDataUsingCoords(coords, data, value) {\n                let coord = coords.shift();\n                if (!isNaN(Number(coord)))\n                    coord = Number(coord);\n\n                if (coords.length) {\n                    addDataUsingCoords(coords, data[coord], value);\n                } else {\n                    if (Array.isArray(data[coord])) {\n                        data[coord].push(value);\n                    }\n                    else {\n                        if (Array.isArray(data)) {\n                            data.push(value);\n                        } else {\n                            data[coord] = value;\n                        }\n                    }\n                }\n            }\n\n            let _data = JSON.parse(JSON.stringify(state.data));\n\n            addDataUsingCoords(coords, _data, blankData);\n\n            return {data: _data};\n        });\n    }\n\n    removeFieldset = (coords) => {\n        coords = coords.split('-');\n        coords.shift();\n\n        this.setState((state) => {\n            function removeDataUsingCoords(coords, data) {\n                let coord = coords.shift();\n                if (!isNaN(Number(coord)))\n                    coord = Number(coord);\n\n                if (coords.length) {\n                    removeDataUsingCoords(coords, data[coord]);\n                } else {\n                    if (Array.isArray(data))\n                        data = data.splice(coord, 1); // in-place mutation\n                    else\n                        delete data[coord];\n                }\n            }\n\n            let _data = JSON.parse(JSON.stringify(state.data));\n\n            removeDataUsingCoords(coords, _data);\n\n            return {data: _data};\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"rjf-form-wrapper\">\n                <fieldset className=\"module aligned\">\n                    <EditorContext.Provider \n                        value={{\n                            fileUploadEndpoint: this.props.fileUploadEndpoint,\n                            fieldName: this.props.fieldName,\n                            modelName: this.props.modelName,\n                        }}\n                    >\n                    {this.getFields()}\n                    </EditorContext.Provider>\n                </fieldset>\n            </div>\n        );\n    }\n}\n","import Form from './form';\n\n\nexport default function JSONForm(config) {\n    this.containerId = config.containerId;\n    this.dataInputId = config.dataInputId;\n    this.schema = config.schema;\n    this.data = config.data;\n    this.fileUploadEndpoint = config.fileUploadEndpoint;\n    this.fieldName = config.fieldName;\n    this.modelName = config.modelName;\n\n    this.render = function() {\n        ReactDOM.render(\n            <Form\n                schema={this.schema}\n                dataInputId={this.dataInputId}\n                data={this.data}\n                fileUploadEndpoint={this.fileUploadEndpoint}\n                fieldName={this.fieldName}\n                modelName={this.modelName}\n            />,\n            document.getElementById(this.containerId)\n        );\n    }\n}","import JSONForm from './renderer';\n\n\nexport default {\n  JSONForm,\n};"],"names":["getBlankObject","schema","keys","schema_keys","properties","key","value","type","getBlankArray","items","push","getBlankData","getSyncedArray","data","newData","JSON","parse","stringify","i","length","item","getSyncedObject","Object","schemaValue","hasOwnProperty","getSyncedData","Button","className","props","children","Loader","EditorContext","React","createContext","capitalize","string","charAt","toUpperCase","substr","toLowerCase","getVerboseName","name","undefined","replace","getCsrfCookie","document","cookie","split","filter","trim","indexOf","FormInput","label","inputRef","ref","FormCheckInput","checked","FormRadioInput","options","map","option","inputValue","toString","FormSelectInput","dataURItoBlob","dataURI","splitted","params","param","binary","atob","array","charCodeAt","blob","window","Blob","Uint8Array","FormFileInput","getFileName","extractFileInfo","dataURL","size","addNameToDataURL","encodeURIComponent","handleChange","e","file","target","files","fileName","reader","FileReader","onload","event","result","onChange","readAsDataURL","endpoint","context","fileUploadEndpoint","console","error","alert","setState","loading","formData","FormData","append","fieldName","modelName","slice","fetch","method","headers","body","then","response","json","file_path","showFileBrowser","current","click","state","createRef","componentDidUpdate","prevProps","prevState","render","Component","contextType","GroupTitle","FormRow","onRemove","FormGroup","hasChildren","Children","count","innerClassName","level","title","addable","onAdd","valueType","callback","isNaN","Number","FormField","inputProps","choices","widget","InputField","format","editable","onEdit","getStringFormRow","removable","getArrayFormRow","rows","groups","min_items","minItems","max_items","maxItems","childName","getObjectFormRow","coords","groupTitle","index","additionalProperties","k","handleKeyEdit","handleKeyValueAdd","prompt","newKey","Form","populateDataInput","dataInput","shift","setDataUsingCoords","coord","_data","getFields","formGroups","addFieldset","removeFieldset","color","blankData","addDataUsingCoords","Array","isArray","removeDataUsingCoords","splice","getElementById","dataInputId","log","JSONForm","config","containerId","ReactDOM"],"mappings":"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"}