{"version":3,"file":"react-json-form.js","sources":["../src/data.js","../src/components/buttons.js","../src/components/loaders.js","../src/util.js","../src/components/form.js","../src/components/containers.js","../src/ui.js","../src/form.js","../src/renderer.js","../src/index.js"],"sourcesContent":["export function getBlankObject(schema) {\n    let keys = {};\n\n    let schema_keys = schema.keys || schema.properties;\n\n    for (let key in schema_keys) {\n        let value = schema_keys[key];\n        let type = value.type;\n\n        if (type === 'list')\n            type = 'array';\n        else if (type === 'dict')\n            type = 'object';\n\n        if (type === 'array')\n            keys[key] = getBlankArray(value);\n        else if (type === 'object')\n            keys[key] = getBlankObject(value);\n        else if (type === 'boolean')\n            keys[key] = value.default || false;\n        else if (type === 'integer' || type === 'number')\n            keys[key] = value.default || null;\n        else // string etc.\n            keys[key] = value.default || '';\n    }\n\n    return keys;\n}\n\n\nexport function getBlankArray(schema) {\n    let items = [];\n    let type = schema.items.type;\n\n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    if (type === 'array')\n        items.push(getBlankArray(schema.items))\n    else if (type === 'object')\n        items.push(getBlankObject(schema.items));\n    else if (type === 'boolean')\n        items.push(schema.items.default || false);\n    else if (type === 'integer' || type === 'number')\n        items.push(schema.items.default || null);\n    else // string, etc.\n        items.push(schema.items.default || '');\n\n    return items;\n}\n\n\nexport function getBlankData(schema) {\n    let type = schema.type;\n\n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    if (type === 'array')\n        return getBlankArray(schema);\n    else if (type === 'object')\n        return getBlankObject(schema);\n    else if (type === 'boolean')\n        return schema.default || false;\n    else if (type === 'integer' || type === 'number')\n        return schema.default || null;\n    else // string, etc.\n        return schema.default || '';\n}\n\n\n\nfunction getSyncedArray(data, schema) {\n    let newData = JSON.parse(JSON.stringify(data));\n\n    let type = schema.items.type;\n    \n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    for (let i = 0; i < data.length; i++) {\n        let item = data[i];\n\n        if (type === 'array') {\n            newData[i] = getSyncedArray(item, schema.items);\n        } else if (type === 'object') {\n            newData[i] = getSyncedObject(item, schema.items);\n        }\n        else {\n            if ((type === 'integer' || type === 'number') && item === '')\n                newData[i] = null;\n        }\n    }\n\n    return newData;\n}\n\n\nfunction getSyncedObject(data, schema) {\n    let newData = JSON.parse(JSON.stringify(data));\n\n    let schema_keys = schema.keys || schema.properties;\n\n    let keys = [...Object.keys(schema_keys)];\n\n    for (let i = 0; i < keys.length; i++) {\n        let key = keys[i];\n        let schemaValue = schema_keys[key];\n        let type = schemaValue.type;\n    \n        if (type === 'list')\n            type = 'array';\n        else if (type === 'dict')\n            type = 'object';\n      \n        if (!data.hasOwnProperty(key)) {\n            if (type === 'array')\n                newData[key] = getSyncedArray([], schemaValue);\n            else if (type === 'object')\n                newData[key] = getSyncedObject({}, schemaValue);\n            else if (type === 'boolean')\n                newData[key] = false;\n            else if (type === 'integer' || type === 'number')\n                newData[key] = null;\n            else\n                newData[key] = '';\n        } else {\n            if (type === 'array')\n                newData[key] = getSyncedArray(data[key], schemaValue);\n            else if (type === 'object')\n                newData[key] = getSyncedObject(data[key], schemaValue);\n            else {\n                if ((type === 'integer' || type === 'number') && data[key] === '')\n                    newData[key] = null;\n                else\n                    newData[key] = data[key];\n            }\n        }\n        \n    }\n\n    return newData;\n}\n\n\nexport function getSyncedData(data, schema) {\n    // adds those keys to data which are in schema but not in data\n\n    let type = schema.type;\n    \n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    if (type === 'array') {\n        return getSyncedArray(data, schema);\n    } else if (type === 'object') {\n        return getSyncedObject(data, schema);\n    }\n\n    return data;\n}\n","export default function Button({className, ...props}) {\n    if (!className)\n        className = '';\n\n    let classes = className.split(' ');\n\n    className = '';\n    for (let i = 0; i < classes.length; i++) {\n        className = className + 'rjf-' + classes[i] + '-button ';\n    }\n\n    return (\n        <button \n            className={className.trim()}\n            type=\"button\"\n            {...props}\n        >\n            {props.children}\n        </button>\n    );\n}","export default function Loader (props) {\n    return <div className=\"rjf-loader\"></div>;\n}\n","export const EditorContext = React.createContext();\n\n\nexport function capitalize(string) {\n    if (!string)\n        return '';\n    \n    return string.charAt(0).toUpperCase() + string.substr(1).toLowerCase();\n}\n\n\nexport function getVerboseName(name) {\n    if (name === undefined || name === null)\n        return '';\n\n    name = name.replace(/_/g, ' ');\n    return capitalize(name);\n}\n\n\nexport function getCsrfCookie() {\n    if ((document.cookie.split(';').filter((item) => item.trim().indexOf('csrftoken=') === 0)).length) {\n        return document.cookie.split(';').filter((item) => item.trim().indexOf('csrftoken=') === 0)[0].split('=')[1];\n    }\n    return null;\n}\n","import Button from './buttons';\nimport Loader from './loaders';\nimport {EditorContext, getCsrfCookie, capitalize} from '../util';\n\n\nexport function FormInput({label, help_text, error, inputRef, ...props}) {\n\n    if (props.type === 'string')\n        props.type = 'text'\n\n    if (inputRef)\n        props.ref = inputRef;\n\n    if (props.value === null)\n        props.value = '';\n\n    return (\n        <div>\n            {label && <label>{label}</label>}\n            <input {...props} />\n        </div>\n    );\n}\n\n\nexport function FormCheckInput({label, help_text, error, value, ...props}) {\n\n    if (!label)\n        label = props.name.toUpperCase();\n\n    if (props.type === 'bool')\n        props.type = 'checkbox';\n\n    if (props.checked === undefined)\n        props.checked = value;\n\n    if (props.checked === '' || props.checked === null || props.checked === undefined)\n        props.checked = false\n\n    if (props.readOnly)\n        props.disabled = true;\n\n    return (\n        <div>\n            <label><input {...props} /> {label}</label>\n        </div>\n    );\n}\n\n\nexport function FormRadioInput({label, help_text, error, value, options, ...props}) {\n    if (props.readOnly)\n        props.disabled = true;\n\n    return (\n        <div>\n            <label>{label}</label>\n            {options.map((option, i) => {\n                let label, inputValue;\n                if (typeof option === 'object') {\n                    label = option.label;\n                    inputValue = option.value;\n                } else {\n                    label = option;\n                    if (typeof label === 'boolean')\n                        label = capitalize(label.toString());\n                    inputValue = option;\n                }\n\n                return (\n                    <label key={label + '_' + inputValue + '_' + i}>\n                        <input {...props} value={inputValue} checked={inputValue === value} /> {label}\n                    </label>\n                );\n            })}\n        </div>\n    );\n}\n\n\nexport function FormSelectInput({label, help_text, error, value, options, ...props}) {\n    if (props.readOnly)\n        props.disabled = true;\n\n    return (\n        <div>\n            {label && <label>{label}</label>}\n            <select value={value || ''} {...props}>\n                <option disabled value=\"\" key={'__placehlder'}>Select...</option>\n                {options.map((option, i) => {\n                    let label, inputValue;\n                    if (typeof option === 'object') {\n                        label = option.label;\n                        inputValue = option.value;\n                    } else {\n                        label = option;\n                        if (typeof label === 'boolean')\n                            label = capitalize(label.toString());\n                        inputValue = option;\n                    }\n\n                    return (\n                        <option value={inputValue} key={label + '_' + inputValue + '_' + i}>\n                            {label}\n                        </option>\n                    );\n                })}\n            </select>\n        </div>\n    );\n}\n\nexport function dataURItoBlob(dataURI) {\n      // Split metadata from data\n      const splitted = dataURI.split(\",\");\n      // Split params\n      const params = splitted[0].split(\";\");\n      // Get mime-type from params\n      const type = params[0].replace(\"data:\", \"\");\n      // Filter the name property from params\n      const properties = params.filter(param => {\n            return param.split(\"=\")[0] === \"name\";\n      });\n      // Look for the name and use unknown if no name property.\n      let name;\n      if (properties.length !== 1) {\n            name = \"unknown\";\n      } else {\n            // Because we filtered out the other property,\n            // we only have the name case here.\n            name = properties[0].split(\"=\")[1];\n      }\n\n      // Built the Uint8Array Blob parameter from the base64 string.\n      const binary = atob(splitted[1]);\n      const array = [];\n      for (let i = 0; i < binary.length; i++) {\n            array.push(binary.charCodeAt(i));\n      }\n      // Create the blob object\n      const blob = new window.Blob([new Uint8Array(array)], { type });\n\n      return {blob, name};\n}\n\n\n\nexport class FormFileInput extends React.Component {\n    static contextType = EditorContext;\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            value: props.value,\n            fileName: this.getFileName(),\n            loading: false\n        };\n\n        this.inputRef = React.createRef();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.props.value !== prevProps.value) {\n            this.setState({\n                value: this.props.value, \n                fileName: this.getFileName()\n            });\n        }\n    }\n\n    getFileName = () => {\n        if (!this.props.value)\n            return '';\n\n        if (this.props.type === 'data-url') {\n            return this.extractFileInfo(this.props.value).name;\n        } else if (this.props.type === 'file-url') {\n            return this.props.value;\n        } else {\n            return 'Unknown file';\n        }\n    }\n\n    extractFileInfo = (dataURL) => {\n        const {blob, name} = dataURItoBlob(dataURL);\n        return {\n            name: name,\n            size: blob.size,\n            type: blob.type\n        }\n    }\n\n    addNameToDataURL = (dataURL, name) => {\n        return dataURL.replace(';base64', ';name=' + encodeURIComponent(name) + ';base64');\n    }\n\n    handleChange = (e) => {\n        if (this.props.type === 'data-url') {\n            let file = e.target.files[0];\n            let fileName = file.name\n\n            let reader = new FileReader();\n\n            reader.onload = () => {\n\n                // this.setState({src: reader.result});\n\n                // we create a fake event object\n                let event = {\n                    target: {\n                        type: 'text',\n                        value: this.addNameToDataURL(reader.result, fileName),\n                        name: this.props.name\n                    }\n                };\n\n                this.props.onChange(event);\n\n            }\n            reader.readAsDataURL(file);\n        } else if (this.props.type === 'file-url') {\n            let endpoint = this.context.fileUploadEndpoint;\n            if (!endpoint) {\n                console.error(\n                    \"Error: fileUploadEndpoint option need to be passed \"\n                    + \"while initializing editor for enabling file uploads.\");\n                alert(\"Files can't be uploaded.\");\n                return;\n            }\n\n            this.setState({loading: true});\n\n            let formData = new FormData();\n            formData.append('field_name', this.context.fieldName);\n            formData.append('model_name', this.context.modelName);\n            formData.append('coordinates', JSON.stringify(this.props.name.split('-').slice(1)));\n            formData.append('file', e.target.files[0]);\n\n            fetch(endpoint, {\n                method: 'POST',\n                headers: {\n                    'X-CSRFToken': getCsrfCookie(),\n                },\n                body: formData\n            })\n            .then((response) => response.json())\n            .then((result) => {\n                // we create a fake event object\n                let event = {\n                    target: {\n                        type: 'text',\n                        value: result.file_path,\n                        name: this.props.name\n                    }\n                };\n\n                this.props.onChange(event);\n                this.setState({loading: false});\n            })\n            .catch((error) => {\n                alert('Something went wrong while uploading file');\n                console.error('Error:', error);\n                this.setState({loading: false});\n            });\n\n        }\n\n    }\n\n    showFileBrowser = () => {\n        this.inputRef.current.click();\n    }\n\n    render() {\n        let {label, value, ...props} = {value, ...this.props};\n        props.type = 'file';\n        props.onChange = this.handleChange;\n\n        if (props.readOnly)\n            props.disabled = true;\n\n\n        return (\n            <div>\n                {label && <label>{label}</label>}\n                <div className=\"rjf-file-field\">\n                    {this.state.value && \n                        <div className=\"rjf-current-file-name\">Current file: <span>{this.state.fileName}</span></div>\n                    }\n                    {this.state.value && !this.state.loading && 'Change:'}\n                    {this.state.loading ?\n                        <div className=\"rjf-file-field-loading\"><Loader/> Uploading...</div>\n                    : \n                    <div className=\"rjf-file-field-input\">\n                        <FormInput {...props} inputRef={this.inputRef} />\n                    </div>\n                    }\n                    </div>\n            </div>\n        );\n    }\n}\n\n\nexport function FormTextareaInput({label, help_text, error, inputRef, ...props}) {\n\n    delete props.type;\n\n    if (inputRef)\n        props.ref = inputRef;\n\n    return (\n        <div>\n            {label && <label>{label}</label>}\n            <textarea {...props} />\n        </div>\n    );\n}\n","import Button from './buttons';\n\n\nexport function GroupTitle(props) {\n    if (!props.children)\n        return null;\n\n    return (\n        <div className=\"rjf-form-group-title\">{props.children}</div>\n    );\n}\n\n\nexport function FormRowControls(props) {\n    return (\n        <div className=\"rjf-form-row-controls\">\n            {props.onMoveUp &&\n                <Button \n                    className=\"move-up\"\n                    onClick={props.onMoveUp}\n                    title=\"Move up\"\n                >\n                    <span>&uarr;</span>\n                </Button>\n            }\n            {props.onMoveDown &&\n                <Button \n                    className=\"move-down\"\n                    onClick={props.onMoveDown}\n                    title=\"Move down\"\n                >\n                    <span>&darr;</span>\n                </Button>\n            }\n            {props.onRemove &&\n                <Button \n                    className=\"remove\"\n                    onClick={props.onRemove}\n                    title=\"Remove\"\n                >\n                    <span>&times;</span>\n                </Button>\n            }\n        </div>\n    );\n}\n\nexport function FormRow(props) {\n    return (\n        <div className=\"rjf-form-row\">\n            <FormRowControls {...props} />\n            <div className=\"rjf-form-row-inner\">\n                {props.children}\n            </div>\n        </div>\n    );\n}\n\n\nexport function FormGroup(props) {\n    let hasChildren = React.Children.count(props.children);\n\n    let innerClassName = props.level === 0 && !hasChildren\n        ? \"\" \n        : \"rjf-form-group-inner\";\n\n    return (\n        <div className=\"rjf-form-group\">\n            {props.level === 0 && <GroupTitle>{props.schema.title}</GroupTitle>}\n            <div className={innerClassName}>\n                {props.level > 0 && <GroupTitle>{props.schema.title}</GroupTitle>}\n                {props.children}\n                {props.addable && \n                <Button\n                    className=\"add\"\n                    onClick={(e) => props.onAdd()}\n                    title=\"Add new\"\n                >\n                    {hasChildren ? 'Add more' : 'Add'}\n                </Button>\n                }\n            </div>\n        </div>\n    );\n}\n","import {getBlankData} from './data';\nimport {Button, FormInput, FormCheckInput, FormRadioInput, FormSelectInput,\n    FormFileInput, FormRow, FormGroup, FormRowControls, FormTextareaInput} from './components';\nimport {getVerboseName} from './util';\n\n\nfunction handleChange(e, fieldType, callback) {\n    let type = e.target.type\n    let value;\n\n    if (type === 'checkbox') {\n        value = e.target.checked;\n    } else {\n        value = e.target.value;\n    }\n\n    if (fieldType === 'number' || fieldType === 'integer') {\n        value = value.trim();\n        if (value === '')\n            value = null;\n        else if (!isNaN(Number(value)))\n            value = Number(value);\n    } else if (fieldType === 'boolean') {\n        if (value === 'false' || value === false)\n            value = false;\n        else\n            value = true;\n    }\n\n    callback(e.target.name, value);\n}\n\n\nfunction FormField(props) {\n    let inputProps = {\n        name: props.name,\n        value: props.data,\n        readOnly: props.schema.readOnly || props.schema.readonly,\n    };\n\n    let type = props.schema.type;\n    if (props.schema.choices) {\n        inputProps.options = props.schema.choices;\n        type = 'select';\n    }\n    if (props.schema.widget)\n        type = props.schema.widget;\n\n    let InputField;\n\n    switch (type) {\n        case 'string':\n            InputField = FormInput;\n\n            if (props.schema.format) {\n                if (props.schema.format === 'data-url' || props.schema.format === 'file-url') {\n                    InputField = FormFileInput;\n                }\n                inputProps.type = props.schema.format;\n            }\n            else {\n                inputProps.type = 'text';\n            }\n            break;\n        case 'number':\n            inputProps.type = 'number';\n            InputField = FormInput;\n            break;\n        case 'integer':\n            inputProps.type = 'number';\n            inputProps.step = '1';\n            InputField = FormInput;\n            break;\n        case 'boolean':\n            inputProps.type = 'checkbox';\n            InputField = FormCheckInput;\n            break;\n        case 'checkbox':\n            inputProps.type = 'checkbox';\n            InputField = FormCheckInput;\n            break;\n        case 'radio':\n            inputProps.type = 'radio';\n            InputField = FormRadioInput;\n            break;\n        case 'select':\n            InputField = FormSelectInput;\n            break;\n        case 'textarea':\n            InputField = FormTextareaInput;\n            break;\n        default:\n            inputProps.type = 'text';\n            InputField = FormInput;\n    }\n\n   return (\n        <InputField \n            {...inputProps}\n            label={\n                props.editable ? <span>{props.schema.title} <Button className=\"edit\" onClick={props.onEdit} title=\"Edit\">Edit</Button></span>\n                :\n                props.schema.title\n            }\n            onChange={(e) => handleChange(e, props.schema.type, props.onChange)}\n        />\n    );\n}\n\n\nexport function getStringFormRow(args) {\n    let {\n        data, schema, name, onChange, onRemove, removable, onEdit, editable, \n        onMoveUp, onMoveDown\n    } = args;\n\n    return (\n        <FormRow \n            key={name}\n            onRemove={removable ? (e) => onRemove(name) : null}\n            onMoveUp={onMoveUp}\n            onMoveDown={onMoveDown}\n        >\n            <FormField \n                data={data}\n                schema={schema}\n                name={name}\n                onChange={onChange}\n                onEdit={onEdit}\n                editable={editable}\n            />\n        </FormRow>\n    );\n}\n\nexport function getArrayFormRow(args) {\n    let {data, schema, name, onChange, onAdd, onRemove, onMove, level} = args;\n\n    let rows = [];\n    let groups = [];\n\n    let removable = true;\n    let min_items = schema.min_items || schema.minItems || 0;\n    if (data.length <= min_items)\n        removable = false;\n\n    let addable = true;\n    let max_items = schema.max_items || schema.maxItems || 100;\n    if (data.length >= max_items)\n        addable = false;\n\n    let type = schema.items.type;\n    \n    if (type === 'list')\n        type = 'array';\n    else if (type === 'dict')\n        type = 'object';\n\n    let nextArgs = {\n        schema: schema.items,\n        onChange: onChange,\n        onAdd: onAdd,\n        onRemove: onRemove,\n        level: level + 1,\n        removable: removable,\n        onMove: onMove,\n    };\n\n    for (let i = 0; i < data.length; i++) {\n        nextArgs.data = data[i];\n        nextArgs.name = name + '-' + i;\n\n        if (i === 0)\n            nextArgs.onMoveUp = null;\n        else\n            nextArgs.onMoveUp = (e) => onMove(name + '-' + i, name + '-' + (i - 1));\n\n        if (i === data.length - 1)\n            nextArgs.onMoveDown = null;\n        else\n            nextArgs.onMoveDown = (e) => onMove(name + '-' + i, name + '-' + (i + 1));;\n\n        if (type === 'array') {\n            groups.push(getArrayFormRow(nextArgs));\n        } else if (type === 'object') {\n            groups.push(getObjectFormRow(nextArgs));\n        } else {\n            rows.push(getStringFormRow(nextArgs));\n        } \n    }\n\n    let coords = name; // coordinates for insertion and deletion\n\n    if (rows.length || (!rows.length && !groups.length)) {\n        rows = (\n            <FormGroup\n                level={level}\n                schema={schema}\n                addable={addable}\n                onAdd={() => onAdd(getBlankData(schema.items), coords)}\n                key={'row_group_' + name}\n            >\n                {rows}\n            </FormGroup>\n        );\n    }\n\n    if (groups.length) {\n        let groupTitle = schema.title ? <div className=\"rjf-form-group-title\">{schema.title}</div> : null;\n\n        groups = (\n            <div key={'group_' + name}>\n                {groupTitle}\n                {groups.map((i, index) => (\n                    <div className=\"rjf-form-group-wrapper\" key={'group_wrapper_' + name + '_' + index}>\n                        <FormRowControls\n                            onRemove={removable ? (e) => onRemove(name + '-' + index) : null}\n                            onMoveUp={index > 0 ? (e) => onMove(name + '-' + index, name + '-' + (index - 1)) : null}\n                            onMoveDown={index < groups.length - 1 ? (e) => onMove(name + '-' + index, name + '-' + (index + 1)) : null}\n                        />\n                        {i}\n                    </div>\n                    )\n                )}\n                {addable && \n                    <Button\n                        className=\"add\"\n                        onClick={(e) => onAdd(getBlankData(schema.items), coords)}\n                        title=\"Add new\"\n                    >\n                        Add item\n                    </Button>\n                }\n            </div>\n        )\n    }\n\n    return [...rows, ...groups];\n}\n\n\nexport function getObjectFormRow(args) {\n    let {data, schema, name, onChange, onAdd, onRemove, level, onMove} = args;\n\n    let rows = [];\n\n    let schema_keys = schema.keys || schema.properties;\n\n    let keys = [...Object.keys(schema_keys)];\n\n    if (schema.additionalProperties)\n        keys = [...keys, ...Object.keys(data).filter((k) => keys.indexOf(k) === -1)];\n\n    for (let i = 0; i < keys.length; i++) {\n        let key = keys[i];\n        let value = data[key];\n        let childName = name + '-' + key;\n        let schemaValue = schema_keys[key] || {type: 'string'};\n\n        let type = schemaValue.type;\n    \n        if (type === 'list')\n            type = 'array';\n        else if (type === 'dict')\n            type = 'object';\n\n        if (!schemaValue.title)\n            schemaValue.title = getVerboseName(key);\n\n        let removable = false;\n        if (schema_keys[key] === undefined)\n            removable = true;\n\n        let nextArgs = {\n            data: value,\n            schema: schemaValue,\n            name: childName,\n            onChange: onChange,\n            onAdd: onAdd,\n            onRemove: onRemove,\n            level: level + 1,\n            removable: removable,\n            onMove: onMove\n        };\n\n         if (type === 'array') {\n            rows.push(getArrayFormRow(nextArgs));\n        } else if (type === 'object') {\n            rows.push(getObjectFormRow(nextArgs));\n        } else {\n            nextArgs.onEdit = () => handleKeyEdit(data, key, value, childName, onAdd, onRemove);\n            nextArgs.editable = removable;\n            rows.push(getStringFormRow(nextArgs));\n        }\n    }\n\n    if (rows.length || schema.additionalProperties) {\n        let className = \"rjf-form-group-inner\";\n        if (level === 0 && !rows.length)\n            className = \"\";\n        \n        let coords = name;\n\n        rows = (\n            <FormGroup\n                level={level}\n                schema={schema}\n                addable={schema.additionalProperties}\n                onAdd={() => handleKeyValueAdd(data, coords, onAdd)}\n                key={'row_group_' + name}\n            >\n                {rows}\n            </FormGroup>\n        );\n    }\n\n    return rows;\n}\n\n\nfunction handleKeyValueAdd(data, coords, onAdd) {\n    let key = prompt(\"Add new key\");\n    if (key === null) // clicked cancel\n        return;\n\n    key = key.trim();\n    if (!key)\n        alert(\"(!) Can't add empty key.\\r\\n\\r\\n‎\");\n    else if (data.hasOwnProperty(key))\n        alert(\"(!) Duplicate keys not allowed. This key already exists.\\r\\n\\r\\n‎\");\n    else\n        onAdd(\"\", coords + '-' + key);   \n}\n\n\nfunction handleKeyEdit(data, key, value, coords, onAdd, onRemove) {\n    let newKey = prompt(\"Rename key\", key);\n    if (newKey === null) // clicked cancel\n        return;\n\n    newKey = newKey.trim();\n\n    if (newKey === key) // same keys\n        return;\n\n    if (!newKey)\n        return alert(\"(!) Key name can't be empty.\\r\\n\\r\\n‎\");\n    else if (data.hasOwnProperty(newKey))\n        return alert(\"(!) Duplicate keys not allowed. This key already exists.\\r\\n\\r\\n‎\");\n\n    onAdd(value, name + '-' + newKey);\n    onRemove(coords);\n}\n","import {getBlankData, getSyncedData} from './data';\nimport {getArrayFormRow, getObjectFormRow} from './ui';\nimport {EditorContext} from './util';\n\n\nexport default class Form extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.dataInput = document.getElementById(this.props.dataInputId);\n        this.schema = props.schema;\n\n        let data = props.data;\n\n        if (!data) {\n            // create empty data from schema\n            data = getBlankData(this.schema);\n        } else {\n            // data might be stale if schema has new keys, so add them to data\n            try {\n                data = getSyncedData(data, this.schema);\n            } catch (error) {\n                console.error(\"Error: Schema and data structure don't match\");\n                console.error(error);\n            }\n        }\n\n        this.state = {\n            value: '',\n            data: data\n        };\n        \n        // update data in the input\n        this.populateDataInput();\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.state.data !== prevState.data) {\n            this.populateDataInput();\n        }\n    }\n\n    populateDataInput = () => {\n        this.dataInput.value = JSON.stringify(this.state.data);\n    }\n\n    handleChange = (coords, value) => {\n        /*\n            e.target.name is a chain of indices and keys:\n            xxx-0-key-1-key2 and so on.\n            These can be used as coordinates to locate \n            a particular deeply nested item.\n\n            This first coordinate is not important and should be removed.\n        */\n        coords = coords.split('-');\n\n        coords.shift(); // remove first coord\n\n        function setDataUsingCoords(coords, data, value) {\n            let coord = coords.shift();\n            if (!isNaN(Number(coord)))\n                coord = Number(coord);\n\n            if (coords.length) {\n                setDataUsingCoords(coords, data[coord], value);\n            } else {\n                data[coord] = value;\n            }\n        }\n\n        let _data = JSON.parse(JSON.stringify(this.state.data));\n\n        setDataUsingCoords(coords, _data, value);\n\n        this.setState({data: _data});\n    }\n\n    getFields = () => {\n        let data = this.state.data;\n        let formGroups = [];\n\n        try {\n            let type = this.schema.type;\n    \n            if (type === 'list')\n                type = 'array';\n            else if (type === 'dict')\n                type = 'object';\n\n            let args = {\n                data: data,\n                schema: this.schema,\n                name: 'rjf',\n                onChange: this.handleChange,\n                onAdd: this.addFieldset,\n                onRemove: this.removeFieldset,\n                onMove: this.moveFieldset,\n                level: 0\n            };\n\n            if (type === 'array') {\n                return getArrayFormRow(args);\n            } else if (type === 'object') {\n                return getObjectFormRow(args);\n            }\n        } catch (error) {\n            formGroups = (\n                <p style={{color: '#f00'}}>\n                    <strong>(!) Error:</strong> Schema and data structure do not match.\n                </p>\n            );\n        }\n\n        return formGroups;\n    }\n\n    addFieldset = (blankData, coords) => {\n        coords = coords.split('-');\n        coords.shift();\n\n        this.setState((state) => {\n            let _data = JSON.parse(JSON.stringify(state.data));\n\n            addDataUsingCoords(coords, _data, blankData);\n\n            return {data: _data};\n        });\n    }\n\n    removeFieldset = (coords) => {\n        coords = coords.split('-');\n        coords.shift();\n\n        this.setState((state) => {\n            let _data = JSON.parse(JSON.stringify(state.data));\n\n            removeDataUsingCoords(coords, _data);\n\n            return {data: _data};\n        });\n    }\n\n    moveFieldset = (oldCoords, newCoords) => {\n        oldCoords = oldCoords.split(\"-\");\n        oldCoords.shift();\n\n        newCoords = newCoords.split(\"-\");\n        newCoords.shift();\n\n        this.setState((state) => {\n            let _data = JSON.parse(JSON.stringify(state.data));\n\n            moveDataUsingCoords(oldCoords, newCoords, _data);\n\n            return {data: _data};\n        });\n    }\n\n    render() {\n        return (\n            <div className=\"rjf-form-wrapper\">\n                <fieldset className=\"module aligned\">\n                    <EditorContext.Provider \n                        value={{\n                            fileUploadEndpoint: this.props.fileUploadEndpoint,\n                            fieldName: this.props.fieldName,\n                            modelName: this.props.modelName,\n                        }}\n                    >\n                    {this.getFields()}\n                    </EditorContext.Provider>\n                </fieldset>\n            </div>\n        );\n    }\n}\n\n\nfunction addDataUsingCoords(coords, data, value) {\n    let coord = coords.shift();\n    if (!isNaN(Number(coord)))\n        coord = Number(coord);\n\n    if (coords.length) {\n        addDataUsingCoords(coords, data[coord], value);\n    } else {\n        if (Array.isArray(data[coord])) {\n            data[coord].push(value);\n        }\n        else {\n            if (Array.isArray(data)) {\n                data.push(value);\n            } else {\n                data[coord] = value;\n            }\n        }\n    }\n}\n\nfunction removeDataUsingCoords(coords, data) {\n    let coord = coords.shift();\n    if (!isNaN(Number(coord)))\n        coord = Number(coord);\n\n    if (coords.length) {\n        removeDataUsingCoords(coords, data[coord]);\n    } else {\n        if (Array.isArray(data))\n            data.splice(coord, 1); // in-place mutation\n        else\n            delete data[coord];\n    }\n}\n\n\nfunction moveDataUsingCoords(oldCoords, newCoords, data) {\n    let oldCoord = oldCoords.shift();\n\n    if (!isNaN(Number(oldCoord)))\n        oldCoord = Number(oldCoord);\n\n    if (oldCoords.length) {\n        moveDataUsingCoords(oldCoords, newCoords, data[oldCoord]);\n    } else {\n        if (Array.isArray(data)) {\n            /* Using newCoords allows us to move items from \n            one array to another. \n            However, for now, we're only moving items in a \n            single array.\n            */\n            let newCoord = newCoords[newCoords.length - 1];\n            \n            let item = data[oldCoord];\n\n            data.splice(oldCoord, 1);\n            data.splice(newCoord, 0, item);\n        }\n    }\n}\n","import Form from './form';\n\n\nexport default function JSONForm(config) {\n    this.containerId = config.containerId;\n    this.dataInputId = config.dataInputId;\n    this.schema = config.schema;\n    this.data = config.data;\n    this.fileUploadEndpoint = config.fileUploadEndpoint;\n    this.fieldName = config.fieldName;\n    this.modelName = config.modelName;\n\n    this.render = function() {\n        ReactDOM.render(\n            <Form\n                schema={this.schema}\n                dataInputId={this.dataInputId}\n                data={this.data}\n                fileUploadEndpoint={this.fileUploadEndpoint}\n                fieldName={this.fieldName}\n                modelName={this.modelName}\n            />,\n            document.getElementById(this.containerId)\n        );\n    }\n}","import JSONForm from './renderer';\n\n\nexport default {\n  JSONForm,\n};"],"names":["getBlankObject","schema","keys","schema_keys","properties","key","value","type","getBlankArray","items","push","getBlankData","getSyncedArray","data","newData","JSON","parse","stringify","i","length","item","getSyncedObject","Object","schemaValue","hasOwnProperty","getSyncedData","Button","className","props","classes","split","trim","children","Loader","EditorContext","React","createContext","capitalize","string","charAt","toUpperCase","substr","toLowerCase","getVerboseName","name","undefined","replace","getCsrfCookie","document","cookie","filter","indexOf","FormInput","label","inputRef","ref","FormCheckInput","checked","readOnly","disabled","FormRadioInput","options","map","option","inputValue","toString","FormSelectInput","dataURItoBlob","dataURI","splitted","params","param","binary","atob","array","charCodeAt","blob","window","Blob","Uint8Array","FormFileInput","getFileName","extractFileInfo","dataURL","size","addNameToDataURL","encodeURIComponent","handleChange","e","file","target","files","fileName","reader","FileReader","onload","event","result","onChange","readAsDataURL","endpoint","context","fileUploadEndpoint","console","error","alert","setState","loading","formData","FormData","append","fieldName","modelName","slice","fetch","method","headers","body","then","response","json","file_path","showFileBrowser","current","click","state","createRef","componentDidUpdate","prevProps","prevState","render","Component","contextType","FormTextareaInput","GroupTitle","FormRowControls","onMoveUp","onMoveDown","onRemove","FormRow","FormGroup","hasChildren","Children","count","innerClassName","level","title","addable","onAdd","fieldType","callback","isNaN","Number","FormField","inputProps","readonly","choices","widget","InputField","format","step","editable","onEdit","getStringFormRow","args","removable","getArrayFormRow","onMove","rows","groups","min_items","minItems","max_items","maxItems","nextArgs","getObjectFormRow","coords","groupTitle","index","additionalProperties","k","childName","handleKeyEdit","handleKeyValueAdd","prompt","newKey","Form","populateDataInput","dataInput","shift","setDataUsingCoords","coord","_data","getFields","formGroups","addFieldset","removeFieldset","moveFieldset","color","blankData","addDataUsingCoords","removeDataUsingCoords","oldCoords","newCoords","moveDataUsingCoords","getElementById","dataInputId","Array","isArray","splice","oldCoord","newCoord","JSONForm","config","containerId","ReactDOM"],"mappings":"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"}